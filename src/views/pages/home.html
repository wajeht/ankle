<div>
	<div>
		<figure>
			<img src="/img/etc/flex.jpeg" alt="you mirin bro" />
			<figcaption class="animate__animated animate__heartBeat">I snap my leg recently!</figcaption>
		</figure>

		<p style="text-align: center;">Current visitors online: <span id="user-online" class="rainbow-text" style="font-weight: bold;"></span>. You are visitor: count. Don't forgot to <a href="/guest-book" title="guest-book" style="font-weight: bold;">sign my guest book!</a></p>
	</div>

	<h2>ðŸ“ƒ Posts</h2>
	<hr />

	<% for (let i=0; i < posts.length; i++) { %>
	<h2 class="post">
		<a href="/posts/<%= posts[i].title %>" title="<%= posts[i].title %>"> <%= posts[i].title %> </a>
	</h2>
	<% } %>
</div>

<script>
	document.addEventListener('DOMContentLoaded', function () {

		// add new gif beside post gigle
		const posts = document.getElementsByClassName('post');
		if (posts.length > 0) {
			posts[0].innerHTML = posts[0].innerHTML + '<img src="/img/etc/new.gif" width="50" />';
			posts[0].style.display = 'flex';
			posts[0].style.gap = '5px';
		}


		// websocket stuff
		window.socket.on('connect', () => {
			// console.log('socket connected!');
			window.socket.emit('user:online', socket.id);
		});

		window.socket.on('user:online', (users) => {
			// console.log('Online users:', users);
			window.users = users || [];
			if (document.getElementById('user-online')) {
				document.getElementById('user-online').innerText = users.length;
			}
		});

		window.socket.on('disconnect', () => {
			// console.log('socket disconnected!');
			if (document.getElementById('user-online')) {
				document.getElementById('user-online').innerText = window.users.length;
			}
		});
	});
</script>
